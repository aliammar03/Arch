#!/bin/bash

# Check if the script is being run as root
if [[ $EUID -ne 0 ]]; then
    echo "This script must be run as root."
    exit 1
fi

# List available disks
lsblk

# Prompt user to enter the disk name
read -p "Enter the disk name (e.g., /dev/sda): " disk

# Prompt user to confirm the disk selection
read -p "Are you sure you want to format $disk? (y/n): " confirm
if [[ ! $confirm =~ ^[Yy]$ ]]; then
    echo "Operation aborted."
    exit 0
fi

# Format and set label for the first partition
format_partition() {
    local partition=$1
    local label=$2

    # Format the partition with ext4 filesystem
    mkfs.ext4 $partition

    # Set the partition label
    e2label $partition $label

    echo "Partition $partition has been formatted and labeled as $label."
}

# Format the first partition
read -p "Enter the label for the first partition: " label1
format_partition "$disk" "$label1"

# Ask for more partitions
while true; do
    read -p "Do you want to format another partition on $disk? (y/n): " choice
    if [[ $choice =~ ^[Yy]$ ]]; then
        read -p "Enter the partition name (e.g., ${disk}1): " partition
        read -p "Enter the label for $partition: " label
        format_partition "$partition" "$label"
    else
        break
    fi
done

exit 0
